/home/xiawu/py38/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:175: UserWarning: [33mWARN: The default seed argument in `Env.reset` should be `None`, otherwise the environment will by default always be deterministic. Actual default: seed=57241[0m
  logger.warn(
start_time  Fri Sep  1 17:58:41 2023
 learning_rate  0.001
 Start training with total steps:  3000
Using cuda device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
 self.episode  0
seed value  599
Logging to ./results/PPO_Fri Sep  1 17:58:41 2023/tensorboards/PPO/first_run_1
/home/xiawu/project 1.1/CustomEnvs/Custom_Envs/envs/commute_env.py:180: NumbaExperimentalFeatureWarning: Use of isinstance() detected. This is an experimental feature.
  if isinstance(x, list):
/home/xiawu/py38/lib/python3.10/site-packages/numba/core/ir_utils.py:2149: NumbaPendingDeprecationWarning: 
Encountered the use of a type that is scheduled for deprecation: type 'reflected list' found for argument '_Accumulation' of function 'estimated_TT'.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types

File "CustomEnvs/Custom_Envs/envs/commute_env.py", line 192:
@njit(parallel=True)
def estimated_TT(all_time_matrix,  time_list, car_number, _Accumulation, dist, ffspeed):
^

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
/home/xiawu/py38/lib/python3.10/site-packages/numba/core/ir_utils.py:2149: NumbaPendingDeprecationWarning: 
Encountered the use of a type that is scheduled for deprecation: type 'reflected list' found for argument '__Accumulation' of function '__numba_parfor_gufunc_0x7fcfad369000'.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types

File "<string>", line 1:
<source missing, REPL/exec in use?>

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
 self.episode  1
seed value  92697
 self.episode  2
seed value  72265
 self.episode  3
seed value  31227
 self.episode  4
seed value  37610
 self.episode  5
seed value  69751
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30       |
|    ep_rew_mean     | 324      |
| time/              |          |
|    fps             | 0        |
|    iterations      | 1        |
|    time_elapsed    | 2441     |
|    total_timesteps | 150      |
---------------------------------
Early stopping at step 21 due to reaching max kl: 0.08
 self.episode  6
seed value  79511
 self.episode  7
seed value  82272
 self.episode  8
seed value  50110
 self.episode  9
seed value  37855
 self.episode  10
seed value  39163
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 2          |
|    time_elapsed         | 4870       |
|    total_timesteps      | 300        |
| train/                  |            |
|    approx_kl            | 0.04396907 |
|    clip_fraction        | 0.285      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.25      |
|    explained_variance   | -0.00109   |
|    learning_rate        | 0.001      |
|    loss                 | 7.05e+03   |
|    n_updates            | 22         |
|    policy_gradient_loss | -0.0847    |
|    std                  | 0.989      |
|    value_loss           | 1.6e+04    |
----------------------------------------
Early stopping at step 32 due to reaching max kl: 0.08
 self.episode  11
seed value  83260
 self.episode  12
seed value  33335
 self.episode  13
seed value  65583
 self.episode  14
seed value  74381
 self.episode  15
seed value  31129
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 3           |
|    time_elapsed         | 7311        |
|    total_timesteps      | 450         |
| train/                  |             |
|    approx_kl            | 0.046584617 |
|    clip_fraction        | 0.445       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.2        |
|    explained_variance   | -0.0115     |
|    learning_rate        | 0.001       |
|    loss                 | 7.61e+03    |
|    n_updates            | 55          |
|    policy_gradient_loss | -0.112      |
|    std                  | 0.975       |
|    value_loss           | 1.56e+04    |
-----------------------------------------
 self.episode  16
seed value  60747
 self.episode  17
seed value  80621
 self.episode  18
seed value  40099
 self.episode  19
seed value  32440
 self.episode  20
seed value  34029
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 323         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 4           |
|    time_elapsed         | 9743        |
|    total_timesteps      | 600         |
| train/                  |             |
|    approx_kl            | 0.049559772 |
|    clip_fraction        | 0.541       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.15       |
|    explained_variance   | -0.126      |
|    learning_rate        | 0.001       |
|    loss                 | 7.63e+03    |
|    n_updates            | 95          |
|    policy_gradient_loss | -0.118      |
|    std                  | 0.954       |
|    value_loss           | 1.58e+04    |
-----------------------------------------
Early stopping at step 24 due to reaching max kl: 0.08
 self.episode  21
seed value  93584
 self.episode  22
seed value  37386
 self.episode  23
seed value  91739
 self.episode  24
seed value  90152
 self.episode  25
seed value  76045
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 322        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 5          |
|    time_elapsed         | 12161      |
|    total_timesteps      | 750        |
| train/                  |            |
|    approx_kl            | 0.05141585 |
|    clip_fraction        | 0.479      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.07      |
|    explained_variance   | -0.125     |
|    learning_rate        | 0.001      |
|    loss                 | 7.28e+03   |
|    n_updates            | 120        |
|    policy_gradient_loss | -0.112     |
|    std                  | 0.926      |
|    value_loss           | 1.54e+04   |
----------------------------------------
Early stopping at step 9 due to reaching max kl: 0.08
 self.episode  26
seed value  55123
 self.episode  27
seed value  23645
 self.episode  28
seed value  35821
 self.episode  29
seed value  39992
 self.episode  30
seed value  19189
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 323         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 6           |
|    time_elapsed         | 14580       |
|    total_timesteps      | 900         |
| train/                  |             |
|    approx_kl            | 0.059803694 |
|    clip_fraction        | 0.422       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.02       |
|    explained_variance   | -0.163      |
|    learning_rate        | 0.001       |
|    loss                 | 6.95e+03    |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0891     |
|    std                  | 0.925       |
|    value_loss           | 1.59e+04    |
-----------------------------------------
Early stopping at step 24 due to reaching max kl: 0.08
 self.episode  31
seed value  2678
 self.episode  32
seed value  15385
 self.episode  33
seed value  66007
 self.episode  34
seed value  74518
 self.episode  35
seed value  19846
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 323         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 7           |
|    time_elapsed         | 17020       |
|    total_timesteps      | 1050        |
| train/                  |             |
|    approx_kl            | 0.077618025 |
|    clip_fraction        | 0.574       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.99       |
|    explained_variance   | -0.171      |
|    learning_rate        | 0.001       |
|    loss                 | 8.24e+03    |
|    n_updates            | 155         |
|    policy_gradient_loss | -0.119      |
|    std                  | 0.908       |
|    value_loss           | 1.66e+04    |
-----------------------------------------
Early stopping at step 16 due to reaching max kl: 0.09
 self.episode  36
seed value  20341
 self.episode  37
seed value  35809
 self.episode  38
seed value  98652
 self.episode  39
seed value  96015
 self.episode  40
seed value  41156
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 325         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 8           |
|    time_elapsed         | 19367       |
|    total_timesteps      | 1200        |
| train/                  |             |
|    approx_kl            | 0.050019674 |
|    clip_fraction        | 0.448       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.97       |
|    explained_variance   | -0.193      |
|    learning_rate        | 0.001       |
|    loss                 | 6.01e+03    |
|    n_updates            | 172         |
|    policy_gradient_loss | -0.0892     |
|    std                  | 0.909       |
|    value_loss           | 1.59e+04    |
-----------------------------------------
Early stopping at step 9 due to reaching max kl: 0.08
 self.episode  41
seed value  6783
 self.episode  42
seed value  83366
 self.episode  43
seed value  83470
 self.episode  44
seed value  67199
 self.episode  45
seed value  32400
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 9          |
|    time_elapsed         | 21750      |
|    total_timesteps      | 1350       |
| train/                  |            |
|    approx_kl            | 0.05586712 |
|    clip_fraction        | 0.346      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.96      |
|    explained_variance   | -0.38      |
|    learning_rate        | 0.001      |
|    loss                 | 7.72e+03   |
|    n_updates            | 182        |
|    policy_gradient_loss | -0.0828    |
|    std                  | 0.903      |
|    value_loss           | 1.7e+04    |
----------------------------------------
Early stopping at step 15 due to reaching max kl: 0.08
 self.episode  46
seed value  69446
 self.episode  47
seed value  41755
 self.episode  48
seed value  42532
 self.episode  49
seed value  58929
 self.episode  50
seed value  69241
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 10         |
|    time_elapsed         | 24129      |
|    total_timesteps      | 1500       |
| train/                  |            |
|    approx_kl            | 0.06136485 |
|    clip_fraction        | 0.508      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.93      |
|    explained_variance   | -0.212     |
|    learning_rate        | 0.001      |
|    loss                 | 7.74e+03   |
|    n_updates            | 198        |
|    policy_gradient_loss | -0.102     |
|    std                  | 0.894      |
|    value_loss           | 1.73e+04   |
----------------------------------------
Early stopping at step 5 due to reaching max kl: 0.08
 self.episode  51
seed value  13564
 self.episode  52
seed value  60040
 self.episode  53
seed value  7560
 self.episode  54
seed value  61867
 self.episode  55
seed value  99353
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 327         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 11          |
|    time_elapsed         | 26495       |
|    total_timesteps      | 1650        |
| train/                  |             |
|    approx_kl            | 0.045145024 |
|    clip_fraction        | 0.249       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.92       |
|    explained_variance   | -0.176      |
|    learning_rate        | 0.001       |
|    loss                 | 9.99e+03    |
|    n_updates            | 204         |
|    policy_gradient_loss | -0.0439     |
|    std                  | 0.899       |
|    value_loss           | 1.66e+04    |
-----------------------------------------
Early stopping at step 8 due to reaching max kl: 0.08
 self.episode  56
seed value  99114
 self.episode  57
seed value  67309
 self.episode  58
seed value  60774
 self.episode  59
seed value  13993
 self.episode  60
seed value  24794
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 327        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 12         |
|    time_elapsed         | 28916      |
|    total_timesteps      | 1800       |
| train/                  |            |
|    approx_kl            | 0.05189453 |
|    clip_fraction        | 0.348      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.94      |
|    explained_variance   | -0.205     |
|    learning_rate        | 0.001      |
|    loss                 | 8.38e+03   |
|    n_updates            | 213        |
|    policy_gradient_loss | -0.0751    |
|    std                  | 0.901      |
|    value_loss           | 1.66e+04   |
----------------------------------------
Early stopping at step 5 due to reaching max kl: 0.09
 self.episode  61
seed value  6869
 self.episode  62
seed value  34553
 self.episode  63
seed value  6795
 self.episode  64
seed value  95680
 self.episode  65
seed value  93635
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 327        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 13         |
|    time_elapsed         | 31331      |
|    total_timesteps      | 1950       |
| train/                  |            |
|    approx_kl            | 0.07952441 |
|    clip_fraction        | 0.322      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.93      |
|    explained_variance   | -0.207     |
|    learning_rate        | 0.001      |
|    loss                 | 9.94e+03   |
|    n_updates            | 219        |
|    policy_gradient_loss | -0.0686    |
|    std                  | 0.897      |
|    value_loss           | 1.65e+04   |
----------------------------------------
Early stopping at step 3 due to reaching max kl: 0.08
 self.episode  66
seed value  72132
 self.episode  67
seed value  74556
 self.episode  68
seed value  59127
 self.episode  69
seed value  42452
 self.episode  70
seed value  75042
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 328         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 14          |
|    time_elapsed         | 33712       |
|    total_timesteps      | 2100        |
| train/                  |             |
|    approx_kl            | 0.049893808 |
|    clip_fraction        | 0.23        |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.92       |
|    explained_variance   | -0.191      |
|    learning_rate        | 0.001       |
|    loss                 | 8.5e+03     |
|    n_updates            | 223         |
|    policy_gradient_loss | -0.047      |
|    std                  | 0.897       |
|    value_loss           | 1.67e+04    |
-----------------------------------------
Early stopping at step 4 due to reaching max kl: 0.08
 self.episode  71
seed value  13735
 self.episode  72
seed value  38889
 self.episode  73
seed value  42312
 self.episode  74
seed value  82542
 self.episode  75
seed value  42522
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 328         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 15          |
|    time_elapsed         | 36057       |
|    total_timesteps      | 2250        |
| train/                  |             |
|    approx_kl            | 0.057978176 |
|    clip_fraction        | 0.315       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.92       |
|    explained_variance   | -0.201      |
|    learning_rate        | 0.001       |
|    loss                 | 8.59e+03    |
|    n_updates            | 228         |
|    policy_gradient_loss | -0.0585     |
|    std                  | 0.901       |
|    value_loss           | 1.72e+04    |
-----------------------------------------
Early stopping at step 5 due to reaching max kl: 0.08
 self.episode  76
seed value  1815
 self.episode  77
seed value  7679
 self.episode  78
seed value  96338
 self.episode  79
seed value  12679
 self.episode  80
seed value  50851
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 328        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 16         |
|    time_elapsed         | 38471      |
|    total_timesteps      | 2400       |
| train/                  |            |
|    approx_kl            | 0.04417681 |
|    clip_fraction        | 0.274      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.93      |
|    explained_variance   | -0.198     |
|    learning_rate        | 0.001      |
|    loss                 | 8.92e+03   |
|    n_updates            | 234        |
|    policy_gradient_loss | -0.0529    |
|    std                  | 0.898      |
|    value_loss           | 1.74e+04   |
----------------------------------------
Early stopping at step 5 due to reaching max kl: 0.08
 self.episode  81
seed value  2239
 self.episode  82
seed value  33422
 self.episode  83
seed value  52734
 self.episode  84
seed value  69386
 self.episode  85
seed value  57718
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 328         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 17          |
|    time_elapsed         | 40894       |
|    total_timesteps      | 2550        |
| train/                  |             |
|    approx_kl            | 0.043843012 |
|    clip_fraction        | 0.221       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.91       |
|    explained_variance   | -0.238      |
|    learning_rate        | 0.001       |
|    loss                 | 7.6e+03     |
|    n_updates            | 240         |
|    policy_gradient_loss | -0.0617     |
|    std                  | 0.887       |
|    value_loss           | 1.53e+04    |
-----------------------------------------
Early stopping at step 9 due to reaching max kl: 0.08
 self.episode  86
seed value  49012
 self.episode  87
seed value  45523
 self.episode  88
seed value  69246
 self.episode  89
seed value  88142
 self.episode  90
seed value  31458
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 328         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 18          |
|    time_elapsed         | 43307       |
|    total_timesteps      | 2700        |
| train/                  |             |
|    approx_kl            | 0.066161424 |
|    clip_fraction        | 0.412       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.86       |
|    explained_variance   | -0.208      |
|    learning_rate        | 0.001       |
|    loss                 | 5.78e+03    |
|    n_updates            | 250         |
|    policy_gradient_loss | -0.0818     |
|    std                  | 0.876       |
|    value_loss           | 1.57e+04    |
-----------------------------------------
Early stopping at step 22 due to reaching max kl: 0.08
 self.episode  91
seed value  18312
 self.episode  92
seed value  37087
 self.episode  93
seed value  67445
 self.episode  94
seed value  49910
 self.episode  95
seed value  37022
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 328        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 19         |
|    time_elapsed         | 45723      |
|    total_timesteps      | 2850       |
| train/                  |            |
|    approx_kl            | 0.06049938 |
|    clip_fraction        | 0.546      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.82      |
|    explained_variance   | -0.229     |
|    learning_rate        | 0.001      |
|    loss                 | 6.69e+03   |
|    n_updates            | 273        |
|    policy_gradient_loss | -0.114     |
|    std                  | 0.859      |
|    value_loss           | 1.53e+04   |
----------------------------------------
Early stopping at step 2 due to reaching max kl: 0.10
 self.episode  96
seed value  16298
 self.episode  97
seed value  62673
 self.episode  98
seed value  64842
 self.episode  99
seed value  53571
 self.episode  100
seed value  3705
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30        |
|    ep_rew_mean          | 328       |
| time/                   |           |
|    fps                  | 0         |
|    iterations           | 20        |
|    time_elapsed         | 48144     |
|    total_timesteps      | 3000      |
| train/                  |           |
|    approx_kl            | 0.0710866 |
|    clip_fraction        | 0.267     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.78     |
|    explained_variance   | -0.233    |
|    learning_rate        | 0.001     |
|    loss                 | 8.18e+03  |
|    n_updates            | 276       |
|    policy_gradient_loss | -0.0409   |
|    std                  | 0.859     |
|    value_loss           | 1.58e+04  |
---------------------------------------
/home/xiawu/py38/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:175: UserWarning: [33mWARN: The default seed argument in `Env.reset` should be `None`, otherwise the environment will by default always be deterministic. Actual default: seed=57241[0m
  logger.warn(
Early stopping at step 3 due to reaching max kl: 0.08
 
finish training!!!!!!!!!!!!!!!!!
 
 Start testing with total eps:  20
 self.episode  0
seed value  5208
 self.episode  1
seed value  14105
 self.episode  2
seed value  62626
 self.episode  3
seed value  3840
 self.episode  4
seed value  96168
 self.episode  5
seed value  54471
 self.episode  6
seed value  59144
 self.episode  7
seed value  44780
 self.episode  8
seed value  41580
 self.episode  9
seed value  47484
 self.episode  10
seed value  54006
 self.episode  11
seed value  33331
 self.episode  12
seed value  57716
 self.episode  13
seed value  90549
 self.episode  14
seed value  1494
 self.episode  15
seed value  23097
 self.episode  16
seed value  91952
 self.episode  17
seed value  90069
 self.episode  18
seed value  61511
 self.episode  19
seed value  86155
finish test¡ng!!!!!!!!!!!!!!!!!
end_time  Sat Sep  2 09:59:17 2023
total elapsed time  57636.235310554504
