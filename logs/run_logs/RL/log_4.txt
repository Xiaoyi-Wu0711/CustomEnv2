/home/xiawu/py38/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:175: UserWarning: [33mWARN: The default seed argument in `Env.reset` should be `None`, otherwise the environment will by default always be deterministic. Actual default: seed=10346[0m
  logger.warn(
start_time  Mon Sep  4 13:21:56 2023
 learning_rate  0.01
 resume from: PPO_Sun Sep  3 14:00:48 2023 
 Start training with total steps:  3000
== CURRENT SYSTEM INFO ==
- OS: Linux-6.2.0-26-generic-x86_64-with-glibc2.35 # 26~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Thu Jul 13 16:27:29 UTC 2
- Python: 3.10.12
- Stable-Baselines3: 2.1.0
- PyTorch: 2.0.1+cu117
- GPU Enabled: True
- Numpy: 1.24.4
- Cloudpickle: 2.2.1
- Gymnasium: 0.29.1

== SAVED MODEL SYSTEM INFO ==
- OS: Linux-6.2.0-26-generic-x86_64-with-glibc2.35 # 26~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Thu Jul 13 16:27:29 UTC 2
- Python: 3.10.12
- Stable-Baselines3: 2.1.0
- PyTorch: 2.0.1+cu117
- GPU Enabled: True
- Numpy: 1.24.4
- Cloudpickle: 2.2.1
- Gymnasium: 0.29.1

Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
 self.episode  0
seed value  96946
Logging to ./results/PPO_Sun Sep  3 14:00:48 2023/tensorboards/PPO/second_run_0
/home/xiawu/project 1.1/CustomEnvs/Custom_Envs/envs/commute_env.py:180: NumbaExperimentalFeatureWarning: Use of isinstance() detected. This is an experimental feature.
  if isinstance(x, list):
/home/xiawu/py38/lib/python3.10/site-packages/numba/core/ir_utils.py:2149: NumbaPendingDeprecationWarning: 
Encountered the use of a type that is scheduled for deprecation: type 'reflected list' found for argument '_Accumulation' of function 'estimated_TT'.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types

File "CustomEnvs/Custom_Envs/envs/commute_env.py", line 192:
@njit(parallel=True)
def estimated_TT(all_time_matrix,  time_list, car_number, _Accumulation, dist, ffspeed):
^

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
/home/xiawu/py38/lib/python3.10/site-packages/numba/core/ir_utils.py:2149: NumbaPendingDeprecationWarning: 
Encountered the use of a type that is scheduled for deprecation: type 'reflected list' found for argument '__Accumulation' of function '__numba_parfor_gufunc_0x7f29842b02e0'.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types

File "<string>", line 1:
<source missing, REPL/exec in use?>

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
 self.episode  1
seed value  61102
 self.episode  2
seed value  15025
 self.episode  3
seed value  71275
 self.episode  4
seed value  94782
 self.episode  5
seed value  76017
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30       |
|    ep_rew_mean     | 329      |
| time/              |          |
|    fps             | 0        |
|    iterations      | 1        |
|    time_elapsed    | 2479     |
|    total_timesteps | 3150     |
---------------------------------
Early stopping at step 2 due to reaching max kl: 0.09
 self.episode  6
seed value  27522
 self.episode  7
seed value  64908
 self.episode  8
seed value  65558
 self.episode  9
seed value  64397
 self.episode  10
seed value  51606
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 329        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 2          |
|    time_elapsed         | 4978       |
|    total_timesteps      | 3300       |
| train/                  |            |
|    approx_kl            | 0.09166429 |
|    clip_fraction        | 0.261      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.66      |
|    explained_variance   | -0.478     |
|    learning_rate        | 0.01       |
|    loss                 | 5.69e+03   |
|    n_updates            | 37         |
|    policy_gradient_loss | -0.0309    |
|    std                  | 1.15       |
|    value_loss           | 1.57e+04   |
----------------------------------------
Early stopping at step 1 due to reaching max kl: 0.13
 self.episode  11
seed value  32404
 self.episode  12
seed value  31145
 self.episode  13
seed value  66504
 self.episode  14
seed value  332
 self.episode  15
seed value  32615
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 329        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 3          |
|    time_elapsed         | 7440       |
|    total_timesteps      | 3450       |
| train/                  |            |
|    approx_kl            | 0.13282518 |
|    clip_fraction        | 0.278      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.68      |
|    explained_variance   | -0.659     |
|    learning_rate        | 0.01       |
|    loss                 | 1.11e+04   |
|    n_updates            | 39         |
|    policy_gradient_loss | -0.00752   |
|    std                  | 1.16       |
|    value_loss           | 1.83e+04   |
----------------------------------------
Early stopping at step 1 due to reaching max kl: 0.11
 self.episode  16
seed value  84136
 self.episode  17
seed value  79098
 self.episode  18
seed value  43021
 self.episode  19
seed value  601
 self.episode  20
seed value  25253
--------------------------------------
| rollout/                |          |
|    ep_len_mean          | 30       |
|    ep_rew_mean          | 329      |
| time/                   |          |
|    fps                  | 0        |
|    iterations           | 4        |
|    time_elapsed         | 9911     |
|    total_timesteps      | 3600     |
| train/                  |          |
|    approx_kl            | 0.11256  |
|    clip_fraction        | 0.183    |
|    clip_range           | 0.2      |
|    entropy_loss         | -4.7     |
|    explained_variance   | -0.682   |
|    learning_rate        | 0.01     |
|    loss                 | 7.72e+03 |
|    n_updates            | 41       |
|    policy_gradient_loss | -0.0174  |
|    std                  | 1.16     |
|    value_loss           | 1.79e+04 |
--------------------------------------
Early stopping at step 1 due to reaching max kl: 0.12
 self.episode  21
seed value  86986
 self.episode  22
seed value  89616
 self.episode  23
seed value  4304
 self.episode  24
seed value  43744
 self.episode  25
seed value  15032
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 328         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 5           |
|    time_elapsed         | 12390       |
|    total_timesteps      | 3750        |
| train/                  |             |
|    approx_kl            | 0.094922364 |
|    clip_fraction        | 0.224       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.69       |
|    explained_variance   | -0.768      |
|    learning_rate        | 0.01        |
|    loss                 | 7.3e+03     |
|    n_updates            | 43          |
|    policy_gradient_loss | -0.00925    |
|    std                  | 1.15        |
|    value_loss           | 1.69e+04    |
-----------------------------------------
Early stopping at step 2 due to reaching max kl: 0.09
 self.episode  26
seed value  86548
 self.episode  27
seed value  16018
 self.episode  28
seed value  35728
 self.episode  29
seed value  37607
 self.episode  30
seed value  79615
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 327        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 6          |
|    time_elapsed         | 14875      |
|    total_timesteps      | 3900       |
| train/                  |            |
|    approx_kl            | 0.05501613 |
|    clip_fraction        | 0.313      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.66      |
|    explained_variance   | -0.828     |
|    learning_rate        | 0.01       |
|    loss                 | 1.06e+04   |
|    n_updates            | 46         |
|    policy_gradient_loss | -0.0182    |
|    std                  | 1.14       |
|    value_loss           | 1.73e+04   |
----------------------------------------
Early stopping at step 1 due to reaching max kl: 0.11
 self.episode  31
seed value  59362
 self.episode  32
seed value  1545
 self.episode  33
seed value  25995
 self.episode  34
seed value  62675
 self.episode  35
seed value  42033
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 327        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 7          |
|    time_elapsed         | 17344      |
|    total_timesteps      | 4050       |
| train/                  |            |
|    approx_kl            | 0.05252791 |
|    clip_fraction        | 0.289      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.66      |
|    explained_variance   | -0.903     |
|    learning_rate        | 0.01       |
|    loss                 | 8.21e+03   |
|    n_updates            | 48         |
|    policy_gradient_loss | -0.0294    |
|    std                  | 1.15       |
|    value_loss           | 1.72e+04   |
----------------------------------------
Early stopping at step 1 due to reaching max kl: 0.13
 self.episode  36
seed value  4464
 self.episode  37
seed value  18888
 self.episode  38
seed value  32236
 self.episode  39
seed value  41835
 self.episode  40
seed value  20860
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30        |
|    ep_rew_mean          | 327       |
| time/                   |           |
|    fps                  | 0         |
|    iterations           | 8         |
|    time_elapsed         | 19774     |
|    total_timesteps      | 4200      |
| train/                  |           |
|    approx_kl            | 0.1317521 |
|    clip_fraction        | 0.356     |
|    clip_range           | 0.2       |
|    entropy_loss         | -4.68     |
|    explained_variance   | -1.02     |
|    learning_rate        | 0.01      |
|    loss                 | 8.65e+03  |
|    n_updates            | 50        |
|    policy_gradient_loss | -0.000168 |
|    std                  | 1.16      |
|    value_loss           | 1.78e+04  |
---------------------------------------
Early stopping at step 1 due to reaching max kl: 0.09
 self.episode  41
seed value  70338
 self.episode  42
seed value  85469
 self.episode  43
seed value  44289
 self.episode  44
seed value  3481
 self.episode  45
seed value  74195
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 9           |
|    time_elapsed         | 22155       |
|    total_timesteps      | 4350        |
| train/                  |             |
|    approx_kl            | 0.058697224 |
|    clip_fraction        | 0.3         |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.73       |
|    explained_variance   | -1.08       |
|    learning_rate        | 0.01        |
|    loss                 | 9.49e+03    |
|    n_updates            | 52          |
|    policy_gradient_loss | -0.0189     |
|    std                  | 1.19        |
|    value_loss           | 1.74e+04    |
-----------------------------------------
Early stopping at step 2 due to reaching max kl: 0.15
 self.episode  46
seed value  83802
 self.episode  47
seed value  43744
 self.episode  48
seed value  15032
 self.episode  49
seed value  86548
 self.episode  50
seed value  16018
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30        |
|    ep_rew_mean          | 326       |
| time/                   |           |
|    fps                  | 0         |
|    iterations           | 10        |
|    time_elapsed         | 24613     |
|    total_timesteps      | 4500      |
| train/                  |           |
|    approx_kl            | 0.1483087 |
|    clip_fraction        | 0.248     |
|    clip_range           | 0.2       |
|    entropy_loss         | -4.8      |
|    explained_variance   | -1.13     |
|    learning_rate        | 0.01      |
|    loss                 | 7e+03     |
|    n_updates            | 55        |
|    policy_gradient_loss | -0.0259   |
|    std                  | 1.21      |
|    value_loss           | 1.83e+04  |
---------------------------------------
Early stopping at step 2 due to reaching max kl: 0.12
 self.episode  51
seed value  35728
 self.episode  52
seed value  37607
 self.episode  53
seed value  79615
 self.episode  54
seed value  59362
 self.episode  55
seed value  1545
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 11          |
|    time_elapsed         | 27089       |
|    total_timesteps      | 4650        |
| train/                  |             |
|    approx_kl            | 0.089507505 |
|    clip_fraction        | 0.339       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.83       |
|    explained_variance   | -1.33       |
|    learning_rate        | 0.01        |
|    loss                 | 6.05e+03    |
|    n_updates            | 58          |
|    policy_gradient_loss | -0.0253     |
|    std                  | 1.22        |
|    value_loss           | 1.81e+04    |
-----------------------------------------
Early stopping at step 1 due to reaching max kl: 0.08
 self.episode  56
seed value  25995
 self.episode  57
seed value  62675
 self.episode  58
seed value  42033
 self.episode  59
seed value  4464
 self.episode  60
seed value  18888
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 12          |
|    time_elapsed         | 29533       |
|    total_timesteps      | 4800        |
| train/                  |             |
|    approx_kl            | 0.054657195 |
|    clip_fraction        | 0.289       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.84       |
|    explained_variance   | -1.43       |
|    learning_rate        | 0.01        |
|    loss                 | 1.19e+04    |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0269     |
|    std                  | 1.22        |
|    value_loss           | 1.9e+04     |
-----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.13
 self.episode  61
seed value  32236
 self.episode  62
seed value  41835
 self.episode  63
seed value  20860
 self.episode  64
seed value  70338
 self.episode  65
seed value  85469
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 13         |
|    time_elapsed         | 31972      |
|    total_timesteps      | 4950       |
| train/                  |            |
|    approx_kl            | 0.03615599 |
|    clip_fraction        | 0.24       |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.85      |
|    explained_variance   | -1.52      |
|    learning_rate        | 0.01       |
|    loss                 | 8.51e+03   |
|    n_updates            | 61         |
|    policy_gradient_loss | 0.0194     |
|    std                  | 1.23       |
|    value_loss           | 1.87e+04   |
----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.08
 self.episode  66
seed value  44289
 self.episode  67
seed value  3481
 self.episode  68
seed value  74195
 self.episode  69
seed value  83802
 self.episode  70
seed value  43744
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 14          |
|    time_elapsed         | 34418       |
|    total_timesteps      | 5100        |
| train/                  |             |
|    approx_kl            | 0.029944396 |
|    clip_fraction        | 0.3         |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.87       |
|    explained_variance   | -1.66       |
|    learning_rate        | 0.01        |
|    loss                 | 4.98e+03    |
|    n_updates            | 62          |
|    policy_gradient_loss | 0.0132      |
|    std                  | 1.24        |
|    value_loss           | 1.88e+04    |
-----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.09
 self.episode  71
seed value  15032
 self.episode  72
seed value  86548
 self.episode  73
seed value  16018
 self.episode  74
seed value  35728
 self.episode  75
seed value  37607
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 15         |
|    time_elapsed         | 36888      |
|    total_timesteps      | 5250       |
| train/                  |            |
|    approx_kl            | 0.03823573 |
|    clip_fraction        | 0.242      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.89      |
|    explained_variance   | -1.66      |
|    learning_rate        | 0.01       |
|    loss                 | 9.08e+03   |
|    n_updates            | 63         |
|    policy_gradient_loss | 0.0233     |
|    std                  | 1.24       |
|    value_loss           | 1.91e+04   |
----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.12
 self.episode  76
seed value  79615
 self.episode  77
seed value  59362
 self.episode  78
seed value  1545
 self.episode  79
seed value  25995
 self.episode  80
seed value  62675
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 326         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 16          |
|    time_elapsed         | 39360       |
|    total_timesteps      | 5400        |
| train/                  |             |
|    approx_kl            | 0.045464206 |
|    clip_fraction        | 0.427       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.9        |
|    explained_variance   | -1.66       |
|    learning_rate        | 0.01        |
|    loss                 | 9.82e+03    |
|    n_updates            | 64          |
|    policy_gradient_loss | 0.0453      |
|    std                  | 1.25        |
|    value_loss           | 1.99e+04    |
-----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.17
 self.episode  81
seed value  42033
 self.episode  82
seed value  4464
 self.episode  83
seed value  18888
 self.episode  84
seed value  32236
 self.episode  85
seed value  41835
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 17         |
|    time_elapsed         | 41832      |
|    total_timesteps      | 5550       |
| train/                  |            |
|    approx_kl            | 0.06243418 |
|    clip_fraction        | 0.308      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.91      |
|    explained_variance   | -1.71      |
|    learning_rate        | 0.01       |
|    loss                 | 8.86e+03   |
|    n_updates            | 65         |
|    policy_gradient_loss | 0.067      |
|    std                  | 1.25       |
|    value_loss           | 1.84e+04   |
----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.08
 self.episode  86
seed value  20860
 self.episode  87
seed value  70338
 self.episode  88
seed value  85469
 self.episode  89
seed value  44289
 self.episode  90
seed value  3481
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 326        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 18         |
|    time_elapsed         | 44307      |
|    total_timesteps      | 5700       |
| train/                  |            |
|    approx_kl            | 0.03573589 |
|    clip_fraction        | 0.278      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.92      |
|    explained_variance   | -1.87      |
|    learning_rate        | 0.01       |
|    loss                 | 1.24e+04   |
|    n_updates            | 66         |
|    policy_gradient_loss | 0.00821    |
|    std                  | 1.26       |
|    value_loss           | 1.73e+04   |
----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.13
 self.episode  91
seed value  74195
 self.episode  92
seed value  83802
 self.episode  93
seed value  43744
 self.episode  94
seed value  15032
 self.episode  95
seed value  86548
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 327        |
| time/                   |            |
|    fps                  | 0          |
|    iterations           | 19         |
|    time_elapsed         | 46778      |
|    total_timesteps      | 5850       |
| train/                  |            |
|    approx_kl            | 0.04841681 |
|    clip_fraction        | 0.32       |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.94      |
|    explained_variance   | -1.89      |
|    learning_rate        | 0.01       |
|    loss                 | 1.17e+04   |
|    n_updates            | 67         |
|    policy_gradient_loss | 0.0147     |
|    std                  | 1.27       |
|    value_loss           | 1.91e+04   |
----------------------------------------
Early stopping at step 0 due to reaching max kl: 0.11
 self.episode  96
seed value  16018
 self.episode  97
seed value  35728
 self.episode  98
seed value  37607
 self.episode  99
seed value  79615
 self.episode  100
seed value  59362
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 327         |
| time/                   |             |
|    fps                  | 0           |
|    iterations           | 20          |
|    time_elapsed         | 49257       |
|    total_timesteps      | 6000        |
| train/                  |             |
|    approx_kl            | 0.048920136 |
|    clip_fraction        | 0.327       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.98       |
|    explained_variance   | -1.87       |
|    learning_rate        | 0.01        |
|    loss                 | 1.67e+04    |
|    n_updates            | 68          |
|    policy_gradient_loss | 0.0326      |
|    std                  | 1.29        |
|    value_loss           | 1.96e+04    |
-----------------------------------------
/home/xiawu/py38/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:175: UserWarning: [33mWARN: The default seed argument in `Env.reset` should be `None`, otherwise the environment will by default always be deterministic. Actual default: seed=10346[0m
  logger.warn(
Early stopping at step 0 due to reaching max kl: 0.47
 
finish training!!!!!!!!!!!!!!!!!
 
 Start testing with total eps:  20
 self.episode  0
seed value  36881
 self.episode  1
seed value  34168
 self.episode  2
seed value  73404
 self.episode  3
seed value  3344
 self.episode  4
seed value  81961
 self.episode  5
seed value  83519
 self.episode  6
seed value  77081
 self.episode  7
seed value  79550
 self.episode  8
seed value  35038
 self.episode  9
seed value  82088
 self.episode  10
seed value  68115
 self.episode  11
seed value  69329
 self.episode  12
seed value  81299
 self.episode  13
seed value  31516
 self.episode  14
seed value  3400
 self.episode  15
seed value  90070
 self.episode  16
seed value  49414
 self.episode  17
seed value  20836
 self.episode  18
seed value  95198
 self.episode  19
seed value  98975
finish test¡ng!!!!!!!!!!!!!!!!!
end_time  Tue Sep  5 05:47:52 2023
total elapsed time  59155.573405742645
